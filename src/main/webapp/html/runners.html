<!DOCTYPE html>
<html>
  <head>
    <title>Bibs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link href="../styles/bootstrap.min.css" rel="stylesheet">

    </head>
<body>

<div style="margin:12px;">
      
    <ul class="nav nav-tabs">
	  <li><a href="reader.html">Race day</a></li>
	  <li class="active"><a href="/bibs-server/resources/html/runners.html">Runners</a></li>
	  <li><a href="awards.html">Awards</a></li>
	  <li><a href="bibs.html">Admin</a></li>
	</ul>

	<div class="row" style="margin-top:12px;">
	  	<div class="col-md-8">
			<button type="button" class="btn btn-default" 
				style="margin:2px;" onclick="addRunner()">Add</button>
			<button type="button" class="btn btn-default" 
				style="margin:2px;">Import</button>
			<button type="button" class="btn btn-default" 
				style="margin:2px;">Export</button>
			<button type="button" class="btn btn-default" 
				style="margin:2px;" onclick="purge()">Purge</button>
		</div>
	  	<div class="col-md-4">
			    <input type="text" class="form-control" id="query" 
			    	style="width:100px;display:inline;"
			    	placeholder="Type a Bib">
			  <button onclick="search()" class="btn btn-default">Search</button>
		</div>
	</div>
		
	<div id="results"
		style="margin:30px;display:none;"> 
		<table id="raceresults" class="table">
		</table>
	</div>

</div>

<script src="../scripts/jquery-1.10.2.min.js"></script>
<script src="../scripts/bootstrap.min.js"></script>
    
<script>

$(document).ready(getRunners);

function addRunner(){
	document.location="runneredit.html?id=0";
}

function getRunners(){
	readerOn=false;
	var request = $.ajax({
		url: "/bibs-server/raceresults/byevent/ice?page=1&size=50",
		type: "GET",
		dataType: "json"
		});
	request.done(function( data ) {
			var results = $('#raceresults').html();
			for(var i in data){
				results += "<tr>";
				results += "<td><a href=\"runneredit.html?id="+data[i].id+"\">Edit</a></td>";
				results += "<td>"+data[i].bib+"</td>";
				results += "<td>"+data[i].firstname+" "+data[i].lastname+"</td>";
				results += "<td>"+data[i].timeoverall+"</td>";
				results += "<td>"+data[i].city+", "+data[i].state+"</td>";
				results += "<td>"+data[i].age+"</td>";
				results += "<td>"+data[i].gender+"</td>";
				results += "</tr>";
			}
			$('#raceresults').html(results);
			$('#results').show(500);
		});
	request.fail(function( jqXHR, textStatus ) {
		alert( "Error: " + textStatus );
		});
	
}


function search(){
	var request = $.ajax({
		url: "/bibs-server/raceresults/bybib/ice/"+$("#query").val(),
		type: "GET",
		dataType: "json"
		});
	request.done(function( data1 ) {
			var data = [data1];
			for(var i in data){
				results += "<tr>";
				results += "<td><a href=\"runneredit.html?id="+data[i].id+"\">Edit</a></td>";
				results += "<td>"+data[i].bib+"</td>";
				results += "<td>"+data[i].firstname+" "+data[i].lastname+"</td>";
				results += "<td>"+data[i].timeoverall+"</td>";
				results += "<td>"+data[i].city+", "+data[i].state+"</td>";
				results += "<td>"+data[i].age+"</td>";
				results += "<td>"+data[i].gender+"</td>";
				results += "</tr>";
				results += "<tr><td colspan=\"99\"><a href=\"runners.html\">Show All Runners</a</td></tr>";
				
			}
			$('#raceresults').hide();
			$('#raceresults').empty();
			$('#raceresults').html(results);
			$('#raceresults').show(500);
		});
	request.fail(function( jqXHR, textStatus ) {
		alert( "Error: " + textStatus );
		});
	
}
function purge(){
	var request = $.ajax({
		url: "/bibs-server/events/purge?event=19",
		type: "GET",
		dataType: "html"
		});
	request.done(function( data ) {
		$("#raceresults").empty();
		});
	request.fail(function( jqXHR, textStatus ) {
		alert( "Error: " + textStatus );
		});
	
}

function makeTable(tableElement,data){
	for(var i in data){
		var newResults = "";
		newResults += "<tr>";
		newResults += "<td>"+data[i].bib+"</td>";
		newResults += "<td>"+data[i].timeoverall+"</td>";
		newResults += "<td>"+data[i].firstname+" "+data[i].lastname+"</td>";
		newResults += "<td>"+data[i].city+", "+data[i].state+"</td>";
		newResults += "<td>"+data[i].gender+"</td>";
		newResults += "<td>"+data[i].age+"</td>";
		newResults += "</tr>";
		tableElement.prepend(newResults);
	}
	return;
}
</script>

  </body>
</html>
